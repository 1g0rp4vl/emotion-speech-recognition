# emotion-speech-recognition

Распознавание эмоции по речи

Постановка задачи
Задача состоит в том, чтобы научиться по небольшому отрывку речи человека распознавать его эмоцию. Это может быть нужно для создания автоматизированных колл-центров, чтобы LLM могла понять, что отвечать человеку, используя не только сухие текстовые данные, но и понимая, в каком состоянии находится человек.
Формат входных и выходных данных
Входные данные: HTTP POST запрос, передающий айдиофайл.
Выходные данные: JSON, содержащий поле “emotion” – одно из 7: “neutral”, “happy”, “sad”, “angry”, “fearful”, “surprised”, “disgust”, а также словарь “probabilities”, содержащий вероятности, выданные моделью, для всех видов эмоций
Метрики
Самое логичные метрики: accuracy – ожидается около 0.7 (в решениях с Kaggle есть accuracy 0.97, но они допускают ошибку не разделяя актеров на train и test, а просто случайно делят записи), f1-score (по классам отдельно и macro) – ожидаю, что-то около 0.6, это хороший результат по мнению интернет сообщества.
Валидация и тест
Для валидации буду делить набор данных в соотношении 80/20. Также логично было бы использовать в валидационном датасете актеров, отличных от тренировочного, чтобы метрики на валидационном датасете были репрезентативны (модель хорошо работает с новым, незнакомым ей ранее голосом).
Датасеты
RAVDESS: https://www.kaggle.com/datasets/uwrfkaggler/ravdess-emotional-speech-audio
Содержит по 60 записей для каждого из 24 актеров (12 мужчин и 12 женщин), каждая длительностью 3-5 секунд. (всего 1440 записей), содержащие предложения одной из 6 эмоций.
CREMA-D: https://www.kaggle.com/datasets/ejlok1/cremad
Содержит 7442 аудиозаписи от 91 актера разного возраста и национальностей длиной 1-3 секунды.
TESS: https://www.kaggle.com/datasets/ejlok1/toronto-emotional-speech-set-tess
Содержит 2800 записей от 2 актеров, в которых они произносят “Say the word …” – разными эмоциями.
SAVEE: https://www.kaggle.com/datasets/ejlok1/surrey-audiovisual-expressed-emotion-savee
Содержит 480 записей от 4 актеров мужчин от 27 до 31 года
Моделирование
Бейзлайн
Например, можно использовать многоклассовую логистическую регрессию. Это хорошо интерпретируемая и не сложная в реализации модель
Основная модель
Буду использовать самописную сверточную нейронную сеть. Детали можно посмотреть здесь: https://www.kaggle.com/code/mostafaabdlhamed/speech-emotion-recognition-97-25-accuracy/notebook#Feature-extraction. Основная суть заключается в том, что будет несколько сверточных слоев с функцией активации ReLU, между ними будут располагаться BatchNorm, MaxPool и Dropout слои. В конце будет линейный слой и SoftMax для получения вероятностей.
Внедрение
Это будет REST API веб-сервис. Для работы нужны также: валидатор, который будет проверять, что поданные данные корректны (длина не слишком маленькая, расширение соответствует требованиям), preprocessing – обрезание файлов или паддинг и аугментация (для обучения, увеличение датасета за счет некоторых действий с файлом: добавление шума, сдвиг…)
